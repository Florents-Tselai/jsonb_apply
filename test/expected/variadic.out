create function lorem() returns text language sql as $$ select 'lorem ipsum'$$;
select jsonb_apply_variadic('"hello"', 'lorem()');
 jsonb_apply_variadic 
----------------------
 "lorem ipsum"
(1 row)

select jsonb_apply_variadic('"hello"', 'lower(text)', NULL);
 jsonb_apply_variadic 
----------------------
 "hello"
(1 row)

select jsonb_apply_variadic('"hello"', 'upper(text)', NULL);
 jsonb_apply_variadic 
----------------------
 "HELLO"
(1 row)

select jsonb_apply_variadic('"hello"', 'reverse(text)', NULL);
 jsonb_apply_variadic 
----------------------
 "olleh"
(1 row)

select jsonb_apply_variadic('{"f": "John", "l": "Doe", "message": "Who are you?", "arr": ["Hello", {"k": "value"}]}', 'lower(text)', NULL);
                                  jsonb_apply_variadic                                  
----------------------------------------------------------------------------------------
 {"f": "john", "l": "doe", "arr": ["hello", {"k": "value"}], "message": "who are you?"}
(1 row)

select jsonb_apply_variadic('{"f": "John", "l": "Doe", "message": "Who are you?", "arr": ["Hello", {"k": "value"}]}', 'upper(text)', NULL);
                                  jsonb_apply_variadic                                  
----------------------------------------------------------------------------------------
 {"f": "JOHN", "l": "DOE", "arr": ["HELLO", {"k": "VALUE"}], "message": "WHO ARE YOU?"}
(1 row)

select jsonb_apply_variadic('{"f": "John", "l": "Doe", "message": "Who are you?", "arr": ["Hello", {"k": "value"}]}', 'reverse(text)', NULL);
                                  jsonb_apply_variadic                                  
----------------------------------------------------------------------------------------
 {"f": "nhoJ", "l": "eoD", "arr": ["olleH", {"k": "eulav"}], "message": "?uoy era ohW"}
(1 row)

select jsonb_apply_variadic('"hello world"', 'replace(text, text, text)', 'hello', 'bye');
 jsonb_apply_variadic 
----------------------
 "bye world"
(1 row)

select jsonb_apply_variadic('"Pg"', 'repeat(text, integer)', 3);
 jsonb_apply_variadic 
----------------------
 "PgPgPg"
(1 row)

select jsonb_apply_variadic('"abc~@~def~@~ghi"', 'split_part(text,text,integer)', '~@~', 2);
 jsonb_apply_variadic 
----------------------
 "def"
(1 row)

